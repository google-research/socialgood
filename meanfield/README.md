Code for paper "Indexability is Not Enough for Whittle: Improved, Near-Optimal Algorithms for Restless Bandits", Abheek Ghosh, Dheeraj Nagaraj, Manish Jain, Milind Tambe. AAMAS '23. See https://arxiv.org/abs/2211.00112 for more details.

## Mobile Healthcare for Maternal Health (ARMMAN) Experiment
The code for this experiment is in the `ARMMAN.ipynb` file. Executing this file will run the mean-field and the Whittle index algorithms for randomly generated RMABs. (The data of the patients/beneficiaries used in the ARMMAN experiment is private and has not been released.) Most paremeters for the experiment can be set in section `Run the Experiment -> Parameters` of the .ipynb notebook. Implementation of the Mean-Field algorithm can be found in section `Mean-Field`.

## Tuberculosis Healthcare Experiment (and others)
The code for this experiment is in the `MARMAB` folder, which has been forked from https://github.com/killian-34/MAMARB-Lagrange-Policies (further details about the experiments can be found there). The implementation of the mean-field algorithm is in `code/mean_field.py`.

First run `bash make_dirs.sh` to setup directory structure.

Example Usage: `python adherence_simulation.py -N 25 -n 200 -b 0.1 -s 0 -ws 0 -l 40 -d healthcare`
- N: Number of trials to average over
- n: Number of arms
- b: Budget as a fraction of n
- s, ws: Seeds for random generator streams
- l: Length of simulation
- d: Simulation environment


#### Note: The above example command will run the simulation for all policies. To change the policies that are run, edit the `policies` list on line 1263 of adherence_simulation.py or pass the -pc option to run one policy at a time: 

For a specific policy `python adherence_simulation.py -N 25 -n 200 -b 0.1 -s 0 -ws 0 -l 40 -d healthcare -pc 37`
- -pc 0: All zero cost actions
- -pc 21: Hawkins 
- -pc 24: VfNc
- -pc 27: SampleLam
- -pc 37: BLam0.1
- -pc 38: BLam0.2
- -pc 39: BLam0.3
- -pc 40: BLam0.5
- -pc 50: MeanField with number of clusters provided as `--mean_field_clusters` or `-mfc`
- -pc 51: MeanField with no clustering
- -pc 52: MeanField with 20 clusters
- -pc 53: MeanField with 50 clusters
- -pc 54: MeanField with 100 clusters


### Greedy--Reliable--Easy Experiment
This is the additional experiment from https://github.com/killian-34/MAMARB-Lagrange-Policies and can be run executing ` python adherence_simulation.py -N 25 -n 50 -b 0.25 -l 40 -d eng11 -A 10 -pc 51`.


### Failure Examples for Index Policies (Section 4 in paper)
The plots associated with the failure examples given in Section 4 of the paper can be generated by running `python failure_examples.py` in folder `MARMAB/code`.